begin_unit
comment|'#!/usr/bin/python'
nl|'\n'
string|'"""\n\n runant.py\n\n\tThis script is a translation of the runant.pl written by Steve Loughran.\n\tIt runs ant with/out arguments, it should be quite portable (thanks to\n\tthe python os library)\n\tThis script has been tested with Python2.0/Win2K\n\n        Copyright (c) 2001 The Apache Software Foundation.  All rights\n        reserved.\n\n created:         2001-04-11\n author:          Pierre Dittgen pierre.dittgen@criltelecom.com\n\n Assumptions:\n\n - the "java" executable/script is on the command path\n - ANT_HOME has been set\n"""'
newline|'\n'
name|'import'
name|'os'
op|','
name|'os'
op|'.'
name|'path'
op|','
name|'string'
op|','
name|'sys'
newline|'\n'
nl|'\n'
comment|'# Change it to 1 to get extra debug information'
nl|'\n'
DECL|variable|debug
name|'debug'
op|'='
number|'0'
newline|'\n'
nl|'\n'
comment|'#######################################################################'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# check to make sure environment is setup'
nl|'\n'
comment|'#'
nl|'\n'
name|'if'
name|'not'
name|'os'
op|'.'
name|'environ'
op|'.'
name|'has_key'
op|'('
string|"'ANT_HOME'"
op|')'
op|':'
newline|'\n'
indent|'\t'
name|'print'
string|"'\\n\\nANT_HOME *MUST* be set!\\n\\n'"
newline|'\n'
name|'sys'
op|'.'
name|'exit'
op|'('
number|'1'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
DECL|variable|ANT_HOME
indent|'\t'
name|'ANT_HOME'
op|'='
name|'os'
op|'.'
name|'environ'
op|'['
string|"'ANT_HOME'"
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'not'
name|'os'
op|'.'
name|'environ'
op|'.'
name|'has_key'
op|'('
string|"'JAVACMD'"
op|')'
op|':'
newline|'\n'
DECL|variable|JAVACMD
indent|'\t'
name|'JAVACMD'
op|'='
string|"'java'"
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
DECL|variable|JAVACMD
indent|'\t'
name|'JAVACMD'
op|'='
name|'os'
op|'.'
name|'environ'
op|'['
string|"'JAVACMD'"
op|']'
newline|'\n'
nl|'\n'
comment|'# Sets the separator char for CLASSPATH'
nl|'\n'
DECL|variable|SEPARATOR
dedent|''
name|'SEPARATOR'
op|'='
string|"':'"
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'name'
op|'=='
string|"'dos'"
name|'or'
name|'os'
op|'.'
name|'name'
op|'=='
string|"'nt'"
op|':'
newline|'\n'
DECL|variable|SEPARATOR
indent|'\t'
name|'SEPARATOR'
op|'='
string|"';'"
newline|'\n'
nl|'\n'
comment|'# Build up standard classpath'
nl|'\n'
DECL|variable|localpath
dedent|''
name|'localpath'
op|'='
string|"''"
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'environ'
op|'.'
name|'has_key'
op|'('
string|"'CLASSPATH'"
op|')'
op|':'
newline|'\n'
DECL|variable|localpath
indent|'\t'
name|'localpath'
op|'='
name|'os'
op|'.'
name|'environ'
op|'['
string|"'CLASSPATH'"
op|']'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'\t'
name|'if'
name|'debug'
op|':'
newline|'\n'
indent|'\t\t'
name|'print'
string|"'Warning: no initial classpath\\n'"
newline|'\n'
nl|'\n'
comment|'# Add jar files'
nl|'\n'
DECL|variable|LIBDIR
dedent|''
dedent|''
name|'LIBDIR'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'ANT_HOME'
op|','
string|"'lib'"
op|')'
newline|'\n'
DECL|variable|jarfiles
name|'jarfiles'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'file'
name|'in'
name|'os'
op|'.'
name|'listdir'
op|'('
name|'LIBDIR'
op|')'
op|':'
newline|'\n'
indent|'\t'
name|'if'
name|'file'
op|'['
op|'-'
number|'4'
op|':'
op|']'
op|'=='
string|"'.jar'"
op|':'
newline|'\n'
indent|'\t\t'
name|'jarfiles'
op|'.'
name|'append'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'LIBDIR'
op|','
name|'file'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'debug'
op|':'
newline|'\n'
indent|'\t'
name|'print'
string|"'Jar files:'"
newline|'\n'
name|'for'
name|'jar'
name|'in'
name|'jarfiles'
op|':'
newline|'\n'
indent|'\t\t'
name|'print'
name|'jar'
newline|'\n'
DECL|variable|localpath
dedent|''
dedent|''
name|'localpath'
op|'='
name|'localpath'
op|'+'
name|'SEPARATOR'
op|'+'
name|'string'
op|'.'
name|'join'
op|'('
name|'jarfiles'
op|','
name|'SEPARATOR'
op|')'
newline|'\n'
nl|'\n'
comment|'# If JAVA_HOME is defined, look for tools.jar & classes.zip'
nl|'\n'
comment|'# and add to classpath'
nl|'\n'
name|'if'
name|'os'
op|'.'
name|'environ'
op|'.'
name|'has_key'
op|'('
string|"'JAVA_HOME'"
op|')'
name|'and'
name|'os'
op|'.'
name|'environ'
op|'['
string|"'JAVA_HOME'"
op|']'
op|'!='
string|"''"
op|':'
newline|'\n'
DECL|variable|JAVA_HOME
indent|'\t'
name|'JAVA_HOME'
op|'='
name|'os'
op|'.'
name|'environ'
op|'['
string|"'JAVA_HOME'"
op|']'
newline|'\n'
DECL|variable|TOOLS
name|'TOOLS'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'JAVA_HOME'
op|','
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
string|"'lib'"
op|','
string|"'tools.jar'"
op|')'
op|')'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'TOOLS'
op|')'
op|':'
newline|'\n'
DECL|variable|localpath
indent|'\t\t'
name|'localpath'
op|'='
name|'localpath'
op|'+'
name|'SEPARATOR'
op|'+'
name|'TOOLS'
newline|'\n'
DECL|variable|CLASSES
dedent|''
name|'CLASSES'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'JAVA_HOME'
op|','
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
string|"'lib'"
op|','
string|"'classes.zip'"
op|')'
op|')'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'CLASSES'
op|')'
op|':'
newline|'\n'
DECL|variable|localpath
indent|'\t\t'
name|'localpath'
op|'='
name|'localpath'
op|'+'
name|'SEPARATOR'
op|'+'
name|'CLASSES'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'\t'
name|'print'
string|"'\\n\\nWarning: JAVA_HOME environment variable is not set.\\n'"
op|','
string|"'If the build fails because sun.* classes could not be found\\n'"
op|','
string|"'you will need to set the JAVA_HOME environment variable\\n'"
op|','
string|"'to the installation directory of java\\n'"
newline|'\n'
nl|'\n'
comment|'# Jikes'
nl|'\n'
DECL|variable|ANT_OPTS
dedent|''
name|'ANT_OPTS'
op|'='
op|'['
op|']'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'environ'
op|'.'
name|'has_key'
op|'('
string|"'ANT_OPTS'"
op|')'
op|':'
newline|'\n'
DECL|variable|ANT_OPTS
indent|'\t'
name|'ANT_OPTS'
op|'='
name|'string'
op|'.'
name|'split'
op|'('
name|'os'
op|'.'
name|'environ'
op|'['
string|"'ANT_OPTS'"
op|']'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'os'
op|'.'
name|'environ'
op|'.'
name|'has_key'
op|'('
string|"'JIKESPATH'"
op|')'
op|':'
newline|'\n'
indent|'\t'
name|'ANT_OPTS'
op|'.'
name|'append'
op|'('
string|"'-Djikes.class.path='"
op|'+'
name|'os'
op|'.'
name|'environ'
op|'['
string|"'JIKESPATH'"
op|']'
op|')'
newline|'\n'
nl|'\n'
comment|'# Builds the commandline'
nl|'\n'
dedent|''
name|'cmdline'
op|'='
string|"'%s -classpath %s -Dant.home=%s %s org.apache.tools.ant.Main %s'"
op|'%'
op|'('
name|'JAVACMD'
op|','
name|'localpath'
op|','
name|'ANT_HOME'
op|','
name|'string'
op|'.'
name|'join'
op|'('
name|'ANT_OPTS'
op|','
string|"' '"
op|')'
op|','
name|'string'
op|'.'
name|'join'
op|'('
name|'sys'
op|'.'
name|'argv'
op|'['
number|'1'
op|':'
op|']'
op|','
string|"' '"
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'debug'
op|':'
newline|'\n'
indent|'\t'
name|'print'
string|"'\\n%s\\n\\n'"
op|'%'
op|'('
name|'cmdline'
op|')'
newline|'\n'
nl|'\n'
comment|'# Run the biniou!'
nl|'\n'
dedent|''
name|'os'
op|'.'
name|'system'
op|'('
name|'cmdline'
op|')'
newline|'\n'
endmarker|''
end_unit
