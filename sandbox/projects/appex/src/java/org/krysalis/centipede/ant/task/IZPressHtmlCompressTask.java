begin_unit
begin_comment
comment|/*****************************************************************************  * Copyright (C) The Krysalis project. All rights reserved.                  *  * ------------------------------------------------------------------------- *  * This software is published under the terms of the Krysalis Patchy         *  * Software License version 1.1_01, a copy of which has been included        *  * at the bottom of this file.                                               *  *****************************************************************************/
end_comment
begin_package
DECL|package|org.krysalis.centipede.ant.task
package|package
name|org
operator|.
name|krysalis
operator|.
name|centipede
operator|.
name|ant
operator|.
name|task
package|;
end_package
begin_import
import|import
name|com
operator|.
name|izforge
operator|.
name|izpress
operator|.
name|*
import|;
end_import
begin_import
import|import
name|java
operator|.
name|io
operator|.
name|InputStream
import|;
end_import
begin_import
import|import
name|java
operator|.
name|io
operator|.
name|FileInputStream
import|;
end_import
begin_import
import|import
name|java
operator|.
name|io
operator|.
name|BufferedInputStream
import|;
end_import
begin_import
import|import
name|java
operator|.
name|io
operator|.
name|OutputStream
import|;
end_import
begin_import
import|import
name|java
operator|.
name|io
operator|.
name|FileOutputStream
import|;
end_import
begin_import
import|import
name|java
operator|.
name|io
operator|.
name|Writer
import|;
end_import
begin_import
import|import
name|java
operator|.
name|io
operator|.
name|PrintWriter
import|;
end_import
begin_import
import|import
name|java
operator|.
name|io
operator|.
name|FileWriter
import|;
end_import
begin_import
import|import
name|java
operator|.
name|io
operator|.
name|BufferedWriter
import|;
end_import
begin_import
import|import
name|java
operator|.
name|io
operator|.
name|FileWriter
import|;
end_import
begin_import
import|import
name|java
operator|.
name|io
operator|.
name|IOException
import|;
end_import
begin_import
import|import
name|java
operator|.
name|util
operator|.
name|ArrayList
import|;
end_import
begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|NodeList
import|;
end_import
begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|Node
import|;
end_import
begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|Element
import|;
end_import
begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|Attr
import|;
end_import
begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|Document
import|;
end_import
begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|NamedNodeMap
import|;
end_import
begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|tidy
operator|.
name|Tidy
import|;
end_import
begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|tools
operator|.
name|ant
operator|.
name|BuildException
import|;
end_import
begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|tools
operator|.
name|ant
operator|.
name|taskdefs
operator|.
name|Property
import|;
end_import
begin_comment
comment|/**  * Task to compress html size.  *  * @author<a href="mailto:barozzi@nicolaken.com">Nicola Ken Barozzi</a>  * @created 14 January 2002  */
end_comment
begin_class
DECL|class|IZPressHtmlCompressTask
specifier|public
class|class
name|IZPressHtmlCompressTask
extends|extends
name|org
operator|.
name|apache
operator|.
name|tools
operator|.
name|ant
operator|.
name|Task
block|{
DECL|field|src
specifier|private
name|String
name|src
decl_stmt|;
DECL|field|dest
specifier|private
name|String
name|dest
decl_stmt|;
DECL|field|compressor
specifier|private
name|Compressor
name|compressor
decl_stmt|;
DECL|field|conf
specifier|private
name|CompressorConfig
name|conf
decl_stmt|;
DECL|field|wipeComments
specifier|private
name|String
name|wipeComments
init|=
literal|"true"
decl_stmt|;
DECL|field|wipeBorders
specifier|private
name|String
name|wipeBorders
init|=
literal|"true"
decl_stmt|;
DECL|field|wipeReturns
specifier|private
name|String
name|wipeReturns
init|=
literal|"true"
decl_stmt|;
DECL|field|wipeSpaces
specifier|private
name|String
name|wipeSpaces
init|=
literal|"true"
decl_stmt|;
DECL|field|pw
name|PrintWriter
name|pw
decl_stmt|;
comment|/**    * Constructor.    */
DECL|method|IZPressHtmlCompressTask
specifier|public
name|IZPressHtmlCompressTask
parameter_list|()
block|{
name|super
argument_list|()
expr_stmt|;
block|}
comment|/**    * Initializes the task.    */
DECL|method|init
specifier|public
name|void
name|init
parameter_list|()
block|{
name|super
operator|.
name|init
argument_list|()
expr_stmt|;
comment|// Setup an instance of IZCompressor.
name|conf
operator|=
operator|new
name|CompressorConfig
argument_list|(
literal|false
argument_list|,
literal|false
argument_list|,
literal|true
argument_list|,
literal|true
argument_list|)
expr_stmt|;
block|}
comment|/**    * Run the task.    * @exception org.apache.tools.ant.BuildException The exception raised during task execution.    */
DECL|method|execute
specifier|public
name|void
name|execute
parameter_list|()
throws|throws
name|org
operator|.
name|apache
operator|.
name|tools
operator|.
name|ant
operator|.
name|BuildException
block|{
try|try
block|{
name|FileInputStream
name|in
init|=
operator|new
name|FileInputStream
argument_list|(
name|src
argument_list|)
decl_stmt|;
name|FileOutputStream
name|out
init|=
operator|new
name|FileOutputStream
argument_list|(
name|dest
argument_list|)
decl_stmt|;
name|compressor
operator|=
operator|new
name|Compressor
argument_list|(
name|in
argument_list|,
name|out
argument_list|,
name|conf
argument_list|)
expr_stmt|;
name|compressor
operator|.
name|compress
argument_list|()
expr_stmt|;
name|out
operator|.
name|flush
argument_list|()
expr_stmt|;
name|in
operator|.
name|close
argument_list|()
expr_stmt|;
name|out
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|IOException
name|ioe
parameter_list|)
block|{
throw|throw
operator|new
name|BuildException
argument_list|(
name|ioe
argument_list|)
throw|;
block|}
block|}
DECL|method|setSrc
specifier|public
name|void
name|setSrc
parameter_list|(
name|String
name|src
parameter_list|)
block|{
name|this
operator|.
name|src
operator|=
name|src
expr_stmt|;
block|}
DECL|method|setDest
specifier|public
name|void
name|setDest
parameter_list|(
name|String
name|dest
parameter_list|)
block|{
name|this
operator|.
name|dest
operator|=
name|dest
expr_stmt|;
block|}
DECL|method|setWipeComments
specifier|public
name|void
name|setWipeComments
parameter_list|(
name|String
name|wipeComments
parameter_list|)
block|{
name|this
operator|.
name|wipeComments
operator|=
name|wipeComments
expr_stmt|;
block|}
DECL|method|setWipeBorders
specifier|public
name|void
name|setWipeBorders
parameter_list|(
name|String
name|wipeBorders
parameter_list|)
block|{
name|this
operator|.
name|wipeBorders
operator|=
name|wipeBorders
expr_stmt|;
block|}
DECL|method|setWipeReturns
specifier|public
name|void
name|setWipeReturns
parameter_list|(
name|String
name|wipeReturns
parameter_list|)
block|{
name|this
operator|.
name|wipeReturns
operator|=
name|wipeReturns
expr_stmt|;
block|}
DECL|method|setWipeSpaces
specifier|public
name|void
name|setWipeSpaces
parameter_list|(
name|String
name|wipeSpaces
parameter_list|)
block|{
name|this
operator|.
name|wipeSpaces
operator|=
name|wipeSpaces
expr_stmt|;
block|}
block|}
end_class
begin_comment
comment|/* The Krysalis Patchy Software License, Version 1.1_01 Copyright (c) 2002 Nicola Ken Barozzi.  All rights reserved.  This Licence is compatible with the BSD licence as described and  approved by http://www.opensource.org/, and is based on the Apache Software Licence Version 1.1.  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:   1. Redistributions of source code must retain the above copyright     notice, this list of conditions and the following disclaimer.  2. Redistributions in binary form must reproduce the above copyright    notice, this list of conditions and the following disclaimer in    the documentation and/or other materials provided with the    distribution.  3. The end-user documentation included with the redistribution,    if any, must include the following acknowledgment:       "This product includes software developed for project         Krysalis (http://www.krysalis.org/)."    Alternately, this acknowledgment may appear in the software itself,    if and wherever such third-party acknowledgments normally appear.  4. The names "Krysalis" and "Nicola Ken Barozzi" and    "Krysalis Centipede" must not be used to endorse or promote products    derived from this software without prior written permission. For    written permission, please contact krysalis@nicolaken.org.     5. Products derived from this software may not be called "Krysalis",    "Krysalis Centipede", nor may "Krysalis" appear in their name,    without prior written permission of Nicola Ken Barozzi.  6. This software may contain voluntary contributions made by many     individuals, who decided to donate the code to this project in    respect of this licence.  THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE KRYSALIS PROJECT OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. ====================================================================*/
end_comment
end_unit
